{% extends 'base.html' %}
{% block script %}
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const filterBox = document.querySelector('#filter-box');
        const filterButton = document.querySelector('#filter');
        const sortBox = document.querySelector('#sort-box');
        const sortButton = document.querySelector('#sort');

        sortBox.style.display = 'none';
        filterBox.style.display = 'none';  // Add this line

        sortButton.addEventListener('click', function() {
            if (sortBox.style.display === 'block') {
                sortBox.style.display = 'none';
            } else {
                sortBox.style.display = 'block';
            }
        });

        filterButton.addEventListener('click', function() {
            if (filterBox.style.display === 'block') {
                filterBox.style.display = 'none';
            } else {
                filterBox.style.display = 'block';
            }
        });
    });
    </script>
{% endblock %}
{% block body %}
<div>
    <div class="flex justify-between flex-wrap mb-5">
        <h1 class=" text-blue-700 text-3xl">Activities:</h1>
        <div class="flex justify-end items-center flex-wrap mb-5">
            {% for category in categories %}
            <div class="flex items-center px-1">
              <span
                class="w-3 h-3 rounded-2xl"
                style="background-color: 
                            {% if category.0 == 'professional' %}#3498db
                            {% elif category.0 == 'personal' %}#27ae60
                            {% elif category.0 == 'development' %}#f39c12
                            {% elif category.0 == 'faith' %}#e74c3c
                            {% elif category.0 == 'financial' %}#f1c40f
                            {% endif %};"
              >
              </span>
              <span class="text-gray-500 text-xs ml-1">{{ category.1|title }}</span>
            </div>
            {% endfor %}
          </div>
        {% comment %}  {% endcomment %}
        
      </div>
  <div class="flex items-center relative">
      <a href="{% url 'addActivity' %}"
    class="text-lg bg-blue-600 text-white p-2 rounded-md mr-4">
        New activity
    </a>
    <div class="w-28 h-auto flex flex-col absolute left-36 top-3">
        <div class="flex justify-between">
            <button id="filter">Filter</button>
        
            <button id="sort">Sort by</button>
        </div>
        <div id="filter-box" class=" text-center w-36 bg-white p-3">
            <div class="filter-categories flex flex-col">
                {% comment %} TODO: remove filter or add all activities option {% endcomment %}
                <a href="?category=professional&sort={{ request.GET.sort }}">Professional</a>
                <a href="?category=personal&sort={{ request.GET.sort }}">Personal</a>
                <a href="?category=development&sort={{ request.GET.sort }}">Development</a>
                <a href="?category=faith&sort={{ request.GET.sort }}">Faith</a>
                <a href="?category=financial&sort={{ request.GET.sort }}">Financial</a>
            </div>
        </div>
        <div id="sort-box" class="text-center w-36 bg-white p-3">
            <div class="flex flex-col">
                <a href="?sort=oldest&category={{ request.GET.category }}">Oldest</a>
                <a href="?sort=newest&category={{ request.GET.category }}">Newest</a>
        </div>
    </div>
    </div>
</div>
  <div class=" w-full">
    <div class="my-5 h-64 md:grid md:grid-cols-2 md:gap-5 ">
    {% if activities %}
        {% for activity in activities %} 
        {% with linked_goal=activity.linked_goal %}
            <div
            class="shadow-lg my-3 md:my-0 bg-gray-100 border-l-8 rounded-md"
            style="border-left-color: 
            {% if linked_goal.category == 'professional' %}#3498db
            {% elif linked_goal.category == 'personal' %}#27ae60
            {% elif linked_goal.category == 'development' %}#f39c12
            {% elif linked_goal.category == 'faith' %}#e74c3c
            {% elif linked_goal.category == 'financial' %}#f1c40f
            {% endif %};"
        >
            <a href="{% url 'activity' activity.id %}" class="flex justify-between flex-col p-3">
                <h3 class="text-md capitalize text-blue-950 font-bold">{{ activity.title }}</h3>
                <p class="text-sm">Created: <span class="text-gray-700 italic">{{ activity.created_at }}</span></p>
            </a>
        </div>
        {% endwith %} 
        {% endfor %}
    {% else %}
        <p>No records at this time</p>
    {% endif %}
</div>
</div>
{% endblock body %}
